// Idealni plin => brzine Äestica jedine su znaÄajne veliÄine za promatranje energije
// Argon => trebaju mi i pozicije i brzine

// 1. Uspostavimo poÄetno mikrostanje.
// 2. Napravimo sluÄajnu probnu promjenu u mikrostanju. Primjerice, izaberemo neki
// spin na sluÄajan naÄin i preokrenemo ga.
// 3. Zatim izraÄunamo promjenu energije zbog probne promjene mikrostanja, âˆ†E â‰¡
// Eproba âˆ’Estara.
// 4. Ako je âˆ†E manja ili jednaka nuli, prihvatimo probnu promjenu i prelazimo na 8.
// korak.
// 5. Ako je âˆ†E ve Ìca od nule, izraË‡cunamo veliË‡cinu w = eâˆ’Î²âˆ†E.
// 6. Generiramo sluË‡cajni broj r u jediniË‡cnom intervalu.
// 7. Ako je r â‰¤ w prihva Ìcamo novo mikrostanje; u suprotnom odbacujemo probni
// pomak i zadrÅ¾avamo staro stanje.
// 8. Odredimo vrijednosti Å¾eljenih fizikalnih veliË‡cina.
// 9. Ponavljamo korake (2) do (8) kako bismo skupili dovoljno mikrostanja.
// 10. PeriodiË‡cno raË‡cunamo prosjeke preko mikrostanja.
// Koraci 2 do 7 daju uvjetnu vjerojatnost da je sustav u mikrostanju {sj},
// ako je u prethodnom koraku bio u mikrostanju {si}
// trebamo uzorkovati koordinate r1,r2,..,rN Äestica i volumen sustava V .

// U NPT ansamblu, vjerojatnost mikrostanja je proporcionalna sa eâˆ’(E+PV )
// S obzirom da je tlak fiksan, probna konfiguracija moÅ¾e se generirati iz trenutne konfiguracije ili
// sluÄajnim pomakom Äestice ili sluÄajnom promjenom volumena, primjerice V â†’V +Î´(2râˆ’1),
// gdje je r sluÄajno izabran iz jednolike funkcije razdiobe na jediniÄnom intervalu, a Î´ je maksi-
// malna promjena volumena. Probna konfiguracija se prihvaca ukoliko je âˆ†W â‰¤ 0 i s vjerojat-
// nosti eâˆ’âˆ†W ukoliko je âˆ†W > 0. Nije nuÅ¾no, a ni efikasno mijenjati volumen nakon svakog
// Monte Carlo koraka po Äestici

// Vrijednosti udaljenosti i energije u
// tipiË‡cnim teku Ìcinama za koje je prikladno koristiti Lennard-Jones model interakcije vrlo su male
// u SI jedinicama. Stoga se najË‡ceÅ¡ Ìce biraju Ïƒ i  kao jedinice za udaljenost i energiju. Tako  Ì„der se
// bira za jedinicu mase masa jednog atoma m i zatim se sve druge veliË‡cine izraÅ¾avaju preko Ïƒ, i
// m. Primjerice, za argon je Ïƒ = 3.4 Ã—10âˆ’10 m, e = 1.65 Ã—10âˆ’21 J i m = 6.69 Ã—10âˆ’26 kg.
// {
//   float potE;
//   int i, j;
//   for (i = 0; i < N; i++)
//   {
//     for (j = 0; j < N; j++)
//     {
//       if (i != j)
//       {
//         printf("%f\n", x[indeksWalkera][i]);
//         printf("%f\n", x[indeksWalkera][j]);
//         potE += lennardJones(x[][indeksWalkera]);
//       }
//     }
//   }
//   return potE;
// }

// for (ib = 1; ib <= Nb; ib++) // po bloku
// {
// po blokovima za usrednjavanje
// novi poloÅ¾aj odreÄ‘ujemo uvijek na osnovu prethodnog pa su dobiveni
// podaci u nekoj mjeri korelirani
// kako bismo izbjegli utjecaj korelacija na proraÄun standardne devijacije
// i sliÄnih veliÄina, podatke Ä‡emo blokirati.
// Blokiranje provodimo dijeleÄ‡i cjelokupnu simulaciju na blokove gdje
// svaki blok sadrÅ¾i nekoliko (100, 1000, 5000, ...) koraka
// nakon svakog bloka pohranjujemo:
// â–¶ indeks bloka ib
// â–¶ âŸ¨fâŸ© - usrednjenu vrijednost veliÄine f koju smo akumulirali od poÄetka
// cijele simulacije
// â–¶ âŸ¨fâŸ©b - usrednjenu vrijednost veliÄine f koju smo akumulirali samo
// unutar jednog bloka
// [12:58, 09 / 07 / 2023] ×× ×”: // raÄunamo potencijalnu energiju
// potEtemp = 0;
// for (a = 0; a < N; a++)
// {
//   for (b = a + 1; b < N; b++)
//   {
//     printf("a=%d, i=%d, %f\n", a, i, x[i][a]);
//     printf("%f\n", lennardJones(x[i][a], x[i][b], y[i][a], y[i][b]));
//     potEtemp += lennardJones(x[i][a], x[i][b], y[i][a], y[i][b]);
//   }
// }

// printf("%f\n", potE / 2);

// 3. IzraË‡cunamo âˆ†E, promjenu potencijalne energije sustava zbog probnog pomaka.
// 4. Ako je âˆ†E â‰¤0 nova konfiguracija se prihva Ìca i odlazi se na 8. korak
// 5. Ako je âˆ†E > 0, raË‡cunamo w = eâˆ’Î²âˆ†E.
// 6. Generiramo iz jedolike raspodjele sluË‡cajni broj r u segmentu [0,1].
// 7. Ako je r â‰¤ w, prihva Ìcamo probni pomak; u suprotnom zadrÅ¾avamo prethodno
// mikrostanje.
// 8. OdreÄ‘ujemo Å¾eljene fizikalne veliË‡cine.
// 9. Ponavljamo korake (2) do (8) kako bismo dobili dovoljan broj mikrostanja.
// 10. Sakupljamo podatke koji su nam potrebni za prosjeke traÅ¾enih veliË‡cina

// raÄunaÅ¡ novo neÅ¡ i provjeravaÅ¡ jel random broj spada u to neÅ¡...

// vjerojatnost mikrostanja u NPT ansamblu proporcionalna je s eâˆ’(E(i)+PV ) // E JE SAMO UNUTARNJA ENRGIJA ACCORDING TO WIKIPEDIA!!
// eâˆ’W = eâˆ’Î²PV âˆ’Î²U({s})+N ln V

// postotak_prihvacanja++;
// [13:08, 09/07/2023] ×× ×”: NajÄeÅ¡Ä‡e je potrebno mnogo uzoraka sluÄajnog hoda prije postizanja asimptotske raspod-
// jele vjerojatnosti p(x). Postavlja se pitanje kako izabrati maksimalnu veliÄinu koraka Î´. Ako
// je Î´ prevelik, samo  Ìce mali broj probnih koraka biti prihvaÄ‡en pa  Ìce uzorkovanje od p(x) biti
// neefikasno. S druge strane, ako je Î´ premalen, veliki postotak probnih koraka bit  Ìce prihva Ìcen
// pa  Ìce opet uzorkovanje p(x) biti neefikasno. Grubi kriterij za odabir veliÄine koraka Î´ je da ot-
// prilike jedna tre Ìcina do jedna polovica koraka trebaju biti prihva Ìceni. Tako  Ì„der je dobro izabrati
// i x0 tako da raspodjela xi dostigne asimptotsku raspodjelu Ë‡cim je prije mogu Ìce. OË‡citi je izbor
// poË‡ceti sluË‡cajni hod na vrijednosti od x za koju je p(x) znaË‡cajan
// [13:08, 09/07/2023] ×× ×”: 1. Izabere se probni poloÅ¾aj xproba = xi+ Î´i, gdje je Î´i sluË‡caji broj iz jednolike raspod-
// jele na segmentu [âˆ’Î´,Î´].
// 2. IzraË‡cuna se w = p(xproba)/p(xi).
// i. Ako je w â‰¥1, promjena se prihva Ìca, odnosno xi+1 = xproba.
// ii. Ako je w < 1 generira se sluË‡cajni broj r.
// iii. Ako je r â‰¤w, promjena se prihva Ìca i xi+1 = xproba.
// iv. Ako se promjena ne prihvati onda je xi+1 = xi